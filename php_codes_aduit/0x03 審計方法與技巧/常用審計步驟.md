## **常用審計步驟**
### **程式碼**
做白盒審計當然就必須的擁有程式碼。
<p>
獲得程式碼的渠道很多、開源的都可以官方下載

### **環境**

審計代碼並不只是簡單地閱讀代碼、還需要搭建環境進行實際測試
<p>
當然，你能用大腦推算運行結果的話就當我沒說。
<p>
有些時候、可以是單一環境、但有些特定的漏洞需要一來不同的操作系統、不同的web服務軟件的版本。
<p>
最好準備不同的環境，用虛擬機掛著幾個環境就好。
<p>
同時phpstudy這個環境包也支持一鍵切換程式版本。

### **安裝**

搭建好本地環境、配置好資料庫等相關設置。
<p>
初始化安裝程式。
<p>
用submlie text打開程式碼文件夾

### **網站目錄結構**
- 主目錄
- 模塊目錄
- 插件目錄
- 上傳目錄
- 模板目錄
- 資料目錄
- 配置目錄
- 配置文件
- 公共函數文件
- 安全過濾文件
- Index入口文件
大概看一下、對整套程式碼程式有一個了解。

### **Index文件**
Index文件一般是整個程式的入口，詳細讀一下index文件可以知道程式的架構、運行流程、包含那些配置文件，
<p>
包含哪些過濾文件以及包含那些安全過濾文件，了解程式的業務邏輯。


### **配置文件**
一般類似config.php等文件
<p>
保存一些資料庫相關信息、程式的一些信息。
<p>
先看看資料庫編碼，如果是gbk則可能存在寬字節注入。
<p>
如果變數的值用雙引號、則可能存在雙引號解析代碼執行的問題。

### **來源資料的處理**
然後、通過詳讀 公共函數文件 和 安全過濾文件 等文件，清晰掌握用戶輸入的資料，哪些被過濾，
<p>
哪些無過濾，在哪裡被過濾了，如何過濾的，能否繞過過濾的資料。
<p>
過濾的方式是替換還是正則？有沒有GPC？有沒有使用addslasher()處理？

###　**敏感函數參數回溯**
大多數漏洞產生的原因是由於函數的使用不當造成的。
<p>
所以，根據敏感函數來逆向追踪參數的傳遞過程是比較有用的一種審計方法。
<p>
略懶的我一般直接用Seay法師大大的神器 Seay源代碼審計系統 ，相關用法我就不說了。
<p>
主要是利用正則匹配一些高危函數、關鍵函數以及敏感關鍵字。
<p>
然後分析判斷敏感函數的上下文，追踪參數源頭。
<p>
嘗試控制可控的參數變數。


### **定向功能分析法**
該方法主要是根據程式的業務邏輯來說審計的。
<p>
首先是用瀏覽器逐個訪問瀏覽，看看這套程式有那些功能。
<p>
根據相關功能，大概推測可能存在那些漏洞。
<p>
- 常見功能漏洞：
	- 程式初始安裝
- 繞過install.lock邏輯
	- 站點信息洩漏
	- 物理路徑
	- 服務器相關信息
	- 組建相關信息
- 文件上傳
	- 任意文件上傳漏洞
	- 文件名注入
- 文件管理
	- 任意文件操作
	- 任意文件讀取
	- 跨目錄瀏覽
	- 文件名XSS
	- 任意文件覆蓋
- 登入認證
	- Cookie算法破解
	- 繞過認證
	- 任意用戶登入
	- 萬能密碼
- 資料庫備份恢復
	- 下載資料庫備份文件
	- 執行SQL語句
	- Sql導出一句話
- 找回密碼
	- Token破解
	- 重置管理員帳戶
- 驗證碼
	- 驗證碼爆破
	- 驗證碼繞過