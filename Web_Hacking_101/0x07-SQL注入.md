## **十一、SQL 注入**

>作者：Peter Yaworski
>
>譯者：飛龍
>
>協議：CC BY-NC-SA 4.0

## **描述**
SQL 注入，或者 SQLi 允許黑客將 SQL 語句注入到目標中並訪問它們的資料庫。它的潛力是無窮的，通常使其成為高回報的漏洞，例如，攻擊者能夠執行所有或一些 CURD 操作（創建、讀取、更新、刪除）來獲取資料庫信息。攻擊者甚至能夠完成遠程命令執行。

SQLi 攻擊通常是未轉義輸入的結果，輸入被傳給站點，並用作資料庫查詢的一部分。它的一個例子是：

```PHP
$name = $_GET['name'];
$query = "SELECT * FROM users WHERE name = $name";
```
這裡，來自用戶輸入的傳入值直接被插入到了資料庫查詢中。如果用戶輸入了`test' or 1=1`，查詢就會返回第一條記錄，其中`name = test or 1=1`，所以為第一行。現在在其他情況下，你可能會得到：

```php
$query = "SELECT * FROM users WHERE (name = $name AND password = 12345");
```

這裡，如果你使用了相同的載荷，你的語句最後會變成：
```php
$query = "SELECT * FROM users WHERE (name = 'test' OR 1=1 AND password = 12345");
```
所以這裡，查詢會表現得有些不同（至少是 MySQL）。我們會獲取所有記錄，其中名稱是`test`，或者密碼是`12345`。很顯然我們沒有完成搜索資料庫第一條記錄的目標。因此，我們需要忽略密碼參數，並能夠使用註釋來實現，`test' or 1=1;--`。這裡，我們所做的事情，就是添加一個分號來合理結束 SQL 語句，並且立即添加兩個短橫線（和一個空格）來把後面的所有東西標記為註釋。因此不會被求職。它的結果會和我們初始的例子一樣。

