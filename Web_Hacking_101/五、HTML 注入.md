## **五、HTML 注入**

>作者：Peter Yaworski
>譯者：飛龍
>協議：CC BY-NC-SA 4.0


## **描述**
超文本標記語言（HTML）注入有時也被稱為虛擬污染。這實際上是一個由站點造成的攻擊，該站點允許惡意用戶向其 Web 頁面注入 
<br>
HTML，並且沒有合理處理用戶輸入。換句話說，HTML 注入漏洞是由接收 HTML 
<br>
引起的，通常通過一些之後會呈現在頁面的表單輸入。這個漏洞是獨立的，不同於注入 Javascript，VBscript 等。
<p>
由於 HTML 是用於定義網頁結構的語言，如果攻擊者可以注入 HTML，它們基本上可以改變瀏覽器呈現的內容。有時，這可能會導致頁面外觀的完全改變，
<br>

或在其他情況下，創建表單來欺騙用戶，例如，如果你可以注入HTML，你也許能夠將`<form> `
<br>
標籤添加到頁面，要求用戶重新輸入他們的用戶名和密碼。然而，當提交此表單時，它實際上將信息發送給攻擊者。

---


### 1. Coinbase 評論
```
難度：低
URL： coinbase.com/apps
報告鏈接： https://hackerone.com/reports/104543
報告日期：2015.12.10
獎金：$200
```
描述：
對於此漏洞，報告者識別出 Coinbase 在呈現文本時，實際上在解碼 URI 的編碼值。對於那
<br>
些不熟悉它的人（我在寫這篇文章的時候），URI 中的字符是保留的或未保留的。根據維基
<br>
百科，保留字是有時有特殊意義的字符，如 `/` 和 `&` 。未保留的字符是沒有任何特殊意義的
<br>
字符，通常只是字母。

因此，當字符被 URI 編碼時，它將按照 ASCII 轉換為其字節值，並以百分號（`%`）開頭。所以，`/`變成`%2F`，`&`成為`%26`。另外，ASCII 
<br>
是一種在互聯網上最常見的編碼，直到 UTF-8 出現，它是另一種編碼類型。現在，回到我們的例子，如果攻擊者輸入 HTML：

```html
<h1> This is a test</h1>
```

Coinbase 實際上會將其渲染為純文本，就像你上面看到的那樣。但是，如果用戶提交了 URL 編碼字符，像這樣：

```
%3C%68%31%3E%54%68%69%73%20%69%73%20%61%20%74%65%73%74%3C%2F%68%31%3E
```
Coinbase 實際上會解碼該字符串，並渲染相應的字符，像這樣：

```
This is a test
```

使用它，報告者演示瞭如何提交帶有用戶名和密碼字段的 HTML 表單，Coinbase 會渲染他。如果這個用戶是惡意的，Coinbase 就會渲染一個表單，它將值提交給惡意網站來捕獲憑據（假設人們填充並提交了表單）。


>重要結論
>
>當你測試一個站點時，要檢查它如何處理不同類型的輸入，包括純文本和編碼文本。特別要注意一些接受 URI 編碼值，例如`%2f`>，並渲染其解碼值的站點，這裡是`/`。雖然我們不知道這個例子中，黑客在想什麼，它們可能嘗試了 URI 編碼限製字符，並註意到 Coinbase >會解碼它們。之後他們更一步 URL 編碼了所有字符。

[http://quick-encoder.com/url](http://quick-encoder.com/url) 是一個不錯的 URL 編碼器。你在使用時會注意到，它告訴你非限製字符不需要編碼，並且提供了編碼 URL 安全字符的選項。這就是獲取用於 COinbase 的相同編碼字符串的方式
